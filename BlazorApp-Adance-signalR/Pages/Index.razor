@page "/"


@*@inject IHubContext<ChatHub, IChatHub> hub*@
@inject NavigationManager Navigation
@inject UserManager<IdentityUser> userManager

<AuthorizeView>
    <Authorized Context="authContext">
        <div class="row">

            <div class="col-6">
                <h2 class="mb-2"> Send message to <span class="text-primary fw-bolder">@selectedUser?.UserName </span></h2>

                <EditForm Model="message" OnSubmit="SendMessage">
                    <input @bind="message"/>
                    <input type="submit" value="Send"/>
                </EditForm>

                <hr/>
                <ul>
                    @if (_messages.Any())
                    {
                        foreach (var message in _messages)
                        {
                            <li class="alert-info mt-2">
                                <div class="col-4">
                                    <h5 class="text-warning fw-bolder mx-2">@message.SenderId</h5>
                                    <p class="fw-light text-black-50 mx-2">
                                        @message?.Content
                                    </p>

                                    <h6 class="text-info fw-bold mx-2"> @message.SentAt.ToShortTimeString()</h6>
                                </div>
                            </li>
                        }
                    }
                    else
                    {
                        <p>No messages</p>
                    }
                </ul>
            </div>
            <div class="col-6">
                @foreach (var user in _users)
                {
                    <div class="col-2 d-flex" style="display: inline;">
                        <h5>@user.UserName</h5>
                        <a class="btn btn-success text-white fw-bold" @onclick="() => SelectUser(user)">Select</a>
                    </div>
                }
            </div>
        </div>
    </Authorized>
</AuthorizeView>


@code {


}